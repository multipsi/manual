
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Molecular properties &#8212; MultiPsi manual</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Selecting an active space" href="active-space.html" />
    <link rel="prev" title="MCSCF" href="mcscf.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">MultiPsi manual</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   MultiPsi manual
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Getting started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="install.html">
   Installing the program
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Basic tutorials
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ci.html">
   Configuration interaction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mcscf.html">
   MCSCF
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Molecular properties
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Advanced tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="active-space.html">
   Selecting an active space
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/docs/properties.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/MGDelcey/mtpman"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/MGDelcey/mtpman/issues/new?title=Issue%20on%20page%20%2Fdocs/properties.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/MGDelcey/mtpman/master?urlpath=tree/docs/docs/properties.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#structure-optimization">
   Structure optimization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spectroscopy">
   Spectroscopy
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#state-averaging">
     State-averaging
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#linear-response">
     Linear response
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Molecular properties</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#structure-optimization">
   Structure optimization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spectroscopy">
   Spectroscopy
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#state-averaging">
     State-averaging
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#linear-response">
     Linear response
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="molecular-properties">
<h1>Molecular properties<a class="headerlink" href="#molecular-properties" title="Permalink to this headline">¶</a></h1>
<div class="section" id="structure-optimization">
<h2>Structure optimization<a class="headerlink" href="#structure-optimization" title="Permalink to this headline">¶</a></h2>
<p>One of the most commonly calculated properties in theoretical chemistry is the molecular structure. It is quite common to use structures calculated at a cheaper level of theory, typically DFT, as a starting point since ground state energies are relatively insensitive to the geometry. However, in some cases, especially when strong correlation is significant, one may want to use MCSCF structures instead.</p>
<p>The workflow here is very similar to that of VeloxChem, namely first defining the Gradient Driver, and then give it to the optimizer, which itself is based on GeomeTRIC. The MCSCF gradient driver will automatically choose analytical gradients if available for the specific type of MCSCF calculation performed, numerical gradients otherwise.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, derivative integrals are not available and all gradients are therefore numerical. This should change very soon.</p>
</div>
<p>Let’s illustrate this on a simple O<span class="math notranslate nohighlight">\(_2\)</span> molecule. First, we compute one MCSCF with the <span class="math notranslate nohighlight">\(\pi\)</span> orbitals in the active space.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">veloxchem</span> <span class="k">as</span> <span class="nn">vlx</span>
<span class="kn">import</span> <span class="nn">multipsi</span> <span class="k">as</span> <span class="nn">mtp</span>

<span class="n">O2_xyz</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;2</span>

<span class="s2">O 0.0 0.0 -0.6</span>
<span class="s2">O 0.0 0.0  0.6</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">molecule</span><span class="o">=</span><span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_xyz_string</span><span class="p">(</span><span class="n">O2_xyz</span><span class="p">)</span>
<span class="n">molecule</span><span class="o">.</span><span class="n">set_multiplicity</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">MolecularBasis</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span><span class="s2">&quot;cc-pvdz&quot;</span><span class="p">)</span>

<span class="n">scfdrv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfUnrestrictedDriver</span><span class="p">()</span>
<span class="n">scfdrv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
<span class="n">uhf_orbs</span> <span class="o">=</span> <span class="n">scfdrv</span><span class="o">.</span><span class="n">natural_orbitals</span><span class="p">()</span>

<span class="n">space</span><span class="o">=</span><span class="n">mtp</span><span class="o">.</span><span class="n">OrbSpace</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span><span class="n">uhf_orbs</span><span class="p">)</span>
<span class="n">space</span><span class="o">.</span><span class="n">cas</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mcscfdrv</span><span class="o">=</span><span class="n">mtp</span><span class="o">.</span><span class="n">McscfDriver</span><span class="p">()</span>
<span class="n">mc_results</span> <span class="o">=</span> <span class="n">mcscfdrv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span><span class="n">basis</span><span class="p">,</span><span class="n">space</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Warning * Environment variable OMP_NUM_THREADS not set.
* Warning * Setting OMP_NUM_THREADS to 8.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Reading basis set from file: /opt/anaconda3/envs/vlxenv/lib/python3.9/site-packages/veloxchem/basis/CC-PVDZ      
                                                                                                                          
                                              Molecular Basis (Atomic Basis)                                              
                                             ================================                                             
                                                                                                                          
                               Basis: CC-PVDZ                                                                             
                                                                                                                          
                               Atom Contracted GTOs           Primitive GTOs                                              
                                                                                                                          
                                O   (3S,2P,1D)                (17S,4P,1D)                                                 
                                                                                                                          
                               Contracted Basis Functions : 28                                                            
                               Primitive Basis Functions  : 68                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                            Self Consistent Field Driver Setup                                            
                                           ====================================                                           
                                                                                                                          
                   Wave Function Model             : Spin-Unrestricted Hartree-Fock                                       
                   Initial Guess Model             : Superposition of Atomic Densities                                    
                   Convergence Accelerator         : Two Level Direct Inversion of Iterative Subspace                     
                   Max. Number of Iterations       : 50                                                                   
                   Max. Number of Error Vectors    : 10                                                                   
                   Convergence Threshold           : 1.0e-06                                                              
                   ERI Screening Scheme            : Cauchy Schwarz + Density                                             
                   ERI Screening Mode              : Dynamic                                                              
                   ERI Screening Threshold         : 1.0e-12                                                              
                   Linear Dependence Threshold     : 1.0e-06                                                              
                                                                                                                          
* Info * Nuclear repulsion energy: 28.2227845815 a.u.                                                                     
                                                                                                                          
* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * SAD initial guess computed in 0.00 sec.                                                                          
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Starting Reduced Basis SCF calculation...                                                                        
* Info * ...done. SCF energy in reduced basis set: -149.476779742205 a.u. Time: 0.05 sec.                                 
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               Iter. | Hartree-Fock Energy | Energy Change | Gradient Norm | Max. Gradient | Density Change               
               --------------------------------------------------------------------------------------------               
                  1      -149.542125579047    0.0000000000      0.13766387      0.02716695      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  2      -149.544062025428   -0.0019364464      0.03694035      0.00577490      0.04278216                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  3      -149.544206427498   -0.0001444021      0.00793470      0.00101935      0.01143915                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  4      -149.544214388681   -0.0000079612      0.00166969      0.00028871      0.00263638                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  5      -149.544214746985   -0.0000003583      0.00010855      0.00001729      0.00054642                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  6      -149.544214748589   -0.0000000016      0.00000796      0.00000116      0.00003713                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  7      -149.544214748599   -0.0000000000      0.00000081      0.00000012      0.00000307                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               *** SCF converged in 7 iterations. Time: 0.40 sec.                                                         
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Spin-Unrestricted Hartree-Fock:                                                                            
               -------------------------------                                                                            
               Total Energy                       :     -149.5442147486 a.u.                                              
               Electronic Energy                  :     -177.7669993301 a.u.                                              
               Nuclear Repulsion Energy           :       28.2227845815 a.u.                                              
               ------------------------------------                                                                       
               Gradient Norm                      :        0.0000008141 a.u.                                              
                                                                                                                          
                                                                                                                          
               Ground State Information                                                                                   
               ------------------------                                                                                   
               Charge of Molecule            :  0.0                                                                       
               Magnetic Quantum Number (M_S) :  0.0                                                                       
               Expectation value of S**2     :  0.0000                                                                    
                                                                                                                          
                                                                                                                          
                                             Spin Unrestricted Alpha Orbitals                                             
                                             --------------------------------                                             
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.09891 a.u.                                                                  
               (   1 O   2s  :    -0.36) (   1 O   3s  :    -0.45) (   2 O   2s  :     0.36)                              
               (   2 O   3s  :     0.45)                                                                                  
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.76819 a.u.                                                                  
               (   1 O   1p+1:     0.46) (   1 O   2p+1:     0.27) (   2 O   1p+1:     0.46)                              
               (   2 O   2p+1:     0.27)                                                                                  
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.73566 a.u.                                                                  
               (   1 O   3s  :    -0.27) (   1 O   1p0 :     0.47) (   1 O   2p0 :     0.24)                              
               (   2 O   3s  :    -0.27) (   2 O   1p0 :    -0.47) (   2 O   2p0 :    -0.24)                              
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.65086 a.u.                                                                  
               (   1 O   1p-1:     0.43) (   1 O   2p-1:     0.30) (   2 O   1p-1:     0.43)                              
               (   2 O   2p-1:     0.30)                                                                                  
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.46179 a.u.                                                                  
               (   1 O   1p+1:    -0.53) (   1 O   2p+1:    -0.41) (   2 O   1p+1:     0.53)                              
               (   2 O   2p+1:     0.41)                                                                                  
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.03549 a.u.                                                                  
               (   1 O   1p-1:     0.47) (   1 O   2p-1:     0.50) (   2 O   1p-1:    -0.47)                              
               (   2 O   2p-1:    -0.50)                                                                                  
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.47034 a.u.                                                                  
               (   1 O   2s  :     0.19) (   1 O   3s  :     1.28) (   1 O   1p0 :     0.41)                              
               (   1 O   2p0 :     1.22) (   2 O   2s  :    -0.19) (   2 O   3s  :    -1.28)                              
               (   2 O   1p0 :     0.41) (   2 O   2p0 :     1.22)                                                        
                                                                                                                          
               Molecular Orbital No.  11:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.07886 a.u.                                                                  
               (   1 O   3s  :     1.00) (   1 O   1p0 :    -0.70) (   1 O   2p0 :     1.33)                              
               (   2 O   3s  :    -1.00) (   2 O   1p0 :    -0.70) (   2 O   2p0 :     1.33)                              
                                                                                                                          
               Molecular Orbital No.  12:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.09748 a.u.                                                                  
               (   1 O   1p+1:    -0.67) (   1 O   2p+1:     0.63) (   2 O   1p+1:    -0.67)                              
               (   2 O   2p+1:     0.63)                                                                                  
                                                                                                                          
               Molecular Orbital No.  13:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.11959 a.u.                                                                  
               (   1 O   1p-1:     0.69) (   1 O   2p-1:    -0.61) (   2 O   1p-1:     0.69)                              
               (   2 O   2p-1:    -0.61)                                                                                  
                                                                                                                          
                                             Spin Unrestricted Beta Orbitals                                              
                                             -------------------------------                                              
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.09891 a.u.                                                                  
               (   1 O   2s  :    -0.36) (   1 O   3s  :    -0.45) (   2 O   2s  :     0.36)                              
               (   2 O   3s  :     0.45)                                                                                  
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.76819 a.u.                                                                  
               (   1 O   1p+1:     0.46) (   1 O   2p+1:     0.27) (   2 O   1p+1:     0.46)                              
               (   2 O   2p+1:     0.27)                                                                                  
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.73566 a.u.                                                                  
               (   1 O   3s  :    -0.27) (   1 O   1p0 :     0.47) (   1 O   2p0 :     0.24)                              
               (   2 O   3s  :    -0.27) (   2 O   1p0 :    -0.47) (   2 O   2p0 :    -0.24)                              
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.65086 a.u.                                                                  
               (   1 O   1p-1:     0.43) (   1 O   2p-1:     0.30) (   2 O   1p-1:     0.43)                              
               (   2 O   2p-1:     0.30)                                                                                  
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.46179 a.u.                                                                  
               (   1 O   1p+1:    -0.53) (   1 O   2p+1:    -0.41) (   2 O   1p+1:     0.53)                              
               (   2 O   2p+1:     0.41)                                                                                  
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.03549 a.u.                                                                  
               (   1 O   1p-1:     0.47) (   1 O   2p-1:     0.50) (   2 O   1p-1:    -0.47)                              
               (   2 O   2p-1:    -0.50)                                                                                  
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.47034 a.u.                                                                  
               (   1 O   2s  :     0.19) (   1 O   3s  :     1.28) (   1 O   1p0 :     0.41)                              
               (   1 O   2p0 :     1.22) (   2 O   2s  :    -0.19) (   2 O   3s  :    -1.28)                              
               (   2 O   1p0 :     0.41) (   2 O   2p0 :     1.22)                                                        
                                                                                                                          
               Molecular Orbital No.  11:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.07886 a.u.                                                                  
               (   1 O   3s  :     1.00) (   1 O   1p0 :    -0.70) (   1 O   2p0 :     1.33)                              
               (   2 O   3s  :    -1.00) (   2 O   1p0 :    -0.70) (   2 O   2p0 :     1.33)                              
                                                                                                                          
               Molecular Orbital No.  12:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.09748 a.u.                                                                  
               (   1 O   1p+1:    -0.67) (   1 O   2p+1:     0.63) (   2 O   1p+1:    -0.67)                              
               (   2 O   2p+1:     0.63)                                                                                  
                                                                                                                          
               Molecular Orbital No.  13:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.11959 a.u.                                                                  
               (   1 O   1p-1:     0.69) (   1 O   2p-1:    -0.61) (   2 O   1p-1:     0.69)                              
               (   2 O   2p-1:    -0.61)                                                                                  
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                          Multi-Configurational Self-Consistent Field Driver
                         ====================================================
                                                                                                                          
        ╭────────────────────────────────────╮
        │          Driver settings           │
        ╰────────────────────────────────────╯
          State-specific calculation
          Max. iterations         : 50
          BFGS window             : 5
          Convergence thresholds:
            - Energy change       : 1e-08
            - Gradient norm       : 0.0001
                                                                                                                          
          Integrals in memory
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          Active space definition:
          ------------------------
Number of inactive (occupied) orbitals: 5
Number of active orbitals:              4
Number of virtual orbitals:             19

    This is a CASSCF wavefunction: CAS(6,4)

          CI expansion:
          -------------
Number of determinants:      10


                                                                                                                          
        MCSCF Iterations
        ----------------
                                                                                                                          
     Iter. | Average Energy | E. Change | Grad. Norm | CI Iter. |   Time
     ---------------------------------------------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        1     -149.544777660     0.0e+00      1.6e-03          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        2     -149.545937503    -1.2e-03      5.3e-03          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        3     -149.551099683    -5.2e-03      1.9e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        4     -149.563802299    -1.3e-02      3.7e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        5     -149.577278353    -1.3e-02      4.1e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        6     -149.580051990    -2.8e-03      6.0e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        7     -149.585776147    -5.7e-03      4.5e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        8     -149.592814869    -7.0e-03      4.6e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        9     -149.600068052    -7.3e-03      7.8e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       10     -149.605037069    -5.0e-03      9.9e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       11     -149.608156603    -3.1e-03      1.0e-01          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       12     -149.611610441    -3.5e-03      5.5e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       13     -149.611315019     3.0e-04      5.9e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       14     -149.612445425    -1.1e-03      3.2e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       15     -149.612703066    -2.6e-04      1.3e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       16     -149.612842614    -1.4e-04      3.3e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       17     -149.613084848    -2.4e-04      3.0e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       18     -149.613248765    -1.6e-04      1.9e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       19     -149.613406428    -1.6e-04      1.0e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       20     -149.613443150    -3.7e-05      3.5e-03          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       21     -149.613449788    -6.6e-06      2.1e-03          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       22     -149.613453723    -3.9e-06      1.6e-03          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       23     -149.613456611    -2.9e-06      1.3e-03          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       24     -149.613458917    -2.3e-06      9.5e-04          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       25     -149.613460173    -1.3e-06      6.4e-04          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       26     -149.613460738    -5.6e-07      3.8e-04          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       27     -149.613461010    -2.7e-07      2.6e-04          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       28     -149.613461162    -1.5e-07      2.1e-04          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       29     -149.613461222    -6.0e-08      1.4e-04          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       30     -149.613461236    -1.4e-08      6.7e-05          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       31     -149.613461242    -5.3e-09      4.7e-05          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
** Convergence reached in 31 iterations
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING! Your active orbitals may have changed significantly
Min_overlap = 0.046006011799619696
                                                                                                                          
        Final results
        -------------
                                                                                                                          
                                                                                                                          
* State 1
- Energy: -149.61346124159257
- S^2   : 0.00  (multiplicity = 1.0 )
- Natural orbitals
1.99871 1.99617 1.84334 0.16177
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.75839 a.u.                                                                  
               (   1 O   1p+1:    -0.46) (   1 O   2p+1:    -0.27) (   2 O   1p+1:    -0.46)                              
               (   2 O   2p+1:    -0.27)                                                                                  
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.45010 a.u.                                                                  
               (   1 O   1p+1:    -0.52) (   1 O   2p+1:    -0.41) (   2 O   1p+1:     0.52)                              
               (   2 O   2p+1:     0.41)                                                                                  
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.999 Energy:   -0.97384 a.u.                                                                  
               (   1 O   2s  :     0.26) (   1 O   3s  :     0.37) (   1 O   1p0 :    -0.32)                              
               (   1 O   2p0 :    -0.19) (   2 O   2s  :     0.26) (   2 O   3s  :     0.37)                              
               (   2 O   1p0 :     0.32) (   2 O   2p0 :     0.19)                                                        
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.996 Energy:   -1.09566 a.u.                                                                  
               (   1 O   2s  :     0.36) (   1 O   3s  :     0.46) (   2 O   2s  :    -0.36)                              
               (   2 O   3s  :    -0.46)                                                                                  
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.843 Energy:   -0.61732 a.u.                                                                  
               (   1 O   1p-1:     0.44) (   1 O   2p-1:     0.28) (   2 O   1p-1:     0.44)                              
               (   2 O   2p-1:     0.28)                                                                                  
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.162 Energy:    0.04984 a.u.                                                                  
               (   1 O   1p-1:    -0.59) (   1 O   2p-1:    -0.31) (   2 O   1p-1:     0.59)                              
               (   2 O   2p-1:     0.31)                                                                                  
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.47714 a.u.                                                                  
               (   1 O   2s  :     0.18) (   1 O   3s  :     1.29) (   1 O   1p0 :     0.40)                              
               (   1 O   2p0 :     1.23) (   2 O   2s  :    -0.18) (   2 O   3s  :    -1.29)                              
               (   2 O   1p0 :     0.40) (   2 O   2p0 :     1.23)                                                        
                                                                                                                          
               Molecular Orbital No.  11:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.08965 a.u.                                                                  
               (   1 O   3s  :    -1.00) (   1 O   1p0 :     0.71) (   1 O   2p0 :    -1.32)                              
               (   2 O   3s  :     1.00) (   2 O   1p0 :     0.71) (   2 O   2p0 :    -1.32)                              
                                                                                                                          
               Molecular Orbital No.  12:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.10519 a.u.                                                                  
               (   1 O   1p+1:     0.67) (   1 O   2p+1:    -0.63) (   2 O   1p+1:     0.67)                              
               (   2 O   2p+1:    -0.63)                                                                                  
                                                                                                                          
               Molecular Orbital No.  13:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.11946 a.u.                                                                  
               (   1 O   1p-1:     0.68) (   1 O   2p-1:    -0.62) (   2 O   1p-1:     0.68)                              
               (   2 O   2p-1:    -0.62)                                                                                  
                                                                                                                          
                                                                                                                          
Total MCSCF time: 00:00:00
</pre></div>
</div>
</div>
</div>
<p>Now, we optimize the molecule.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GradDrv</span><span class="o">=</span><span class="n">mtp</span><span class="o">.</span><span class="n">McscfGradientDriver</span><span class="p">(</span><span class="n">mcscfdrv</span><span class="p">)</span>
<span class="n">opt_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">OptimizationDriver</span><span class="p">(</span><span class="n">GradDrv</span><span class="p">)</span>
<span class="n">casscf_opt_geom</span> <span class="o">=</span> <span class="n">opt_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">space</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                Optimization Driver Setup                                                 
                                               ===========================                                                
                                                                                                                          
                                     Coordinate System       :    TRIC                                                    
                                     Constraints             :    No                                                      
                                     Max. Number of Steps    :    300                                                     
                                     Transition State        :    No                                                      
                                     Hessian                 :    never                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                          Multi-Configurational Self-Consistent Field Driver
                         ====================================================
                                                                                                                          
        ╭────────────────────────────────────╮
        │          Driver settings           │
        ╰────────────────────────────────────╯
          State-specific calculation
          Max. iterations         : 50
          BFGS window             : 5
          Convergence thresholds:
            - Energy change       : 1e-08
            - Gradient norm       : 0.0001
                                                                                                                          
          Integrals in memory
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          Active space definition:
          ------------------------
Number of inactive (occupied) orbitals: 5
Number of active orbitals:              4
Number of virtual orbitals:             19

    This is a CASSCF wavefunction: CAS(6,4)

          CI expansion:
          -------------
Number of determinants:      10


                                                                                                                          
        MCSCF Iterations
        ----------------
                                                                                                                          
     Iter. | Average Energy | E. Change | Grad. Norm | CI Iter. |   Time
     ---------------------------------------------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        1     -149.613461242     0.0e+00      4.7e-05          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
** Convergence reached in 1 iterations
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        Final results
        -------------
                                                                                                                          
                                                                                                                          
* State 1
- Energy: -149.61346124159314
- S^2   : 0.00  (multiplicity = 1.0 )
- Natural orbitals
1.99871 1.99617 1.84334 0.16177
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.75839 a.u.                                                                  
               (   1 O   1p+1:     0.46) (   1 O   2p+1:     0.27) (   2 O   1p+1:     0.46)                              
               (   2 O   2p+1:     0.27)                                                                                  
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.45010 a.u.                                                                  
               (   1 O   1p+1:    -0.52) (   1 O   2p+1:    -0.41) (   2 O   1p+1:     0.52)                              
               (   2 O   2p+1:     0.41)                                                                                  
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.999 Energy:   -0.97384 a.u.                                                                  
               (   1 O   2s  :    -0.26) (   1 O   3s  :    -0.37) (   1 O   1p0 :     0.32)                              
               (   1 O   2p0 :     0.19) (   2 O   2s  :    -0.26) (   2 O   3s  :    -0.37)                              
               (   2 O   1p0 :    -0.32) (   2 O   2p0 :    -0.19)                                                        
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.996 Energy:   -1.09566 a.u.                                                                  
               (   1 O   2s  :     0.36) (   1 O   3s  :     0.46) (   2 O   2s  :    -0.36)                              
               (   2 O   3s  :    -0.46)                                                                                  
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.843 Energy:   -0.61732 a.u.                                                                  
               (   1 O   1p-1:    -0.44) (   1 O   2p-1:    -0.28) (   2 O   1p-1:    -0.44)                              
               (   2 O   2p-1:    -0.28)                                                                                  
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.162 Energy:    0.04984 a.u.                                                                  
               (   1 O   1p-1:    -0.59) (   1 O   2p-1:    -0.31) (   2 O   1p-1:     0.59)                              
               (   2 O   2p-1:     0.31)                                                                                  
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.47714 a.u.                                                                  
               (   1 O   2s  :     0.18) (   1 O   3s  :     1.29) (   1 O   1p0 :     0.40)                              
               (   1 O   2p0 :     1.23) (   2 O   2s  :    -0.18) (   2 O   3s  :    -1.29)                              
               (   2 O   1p0 :     0.40) (   2 O   2p0 :     1.23)                                                        
                                                                                                                          
               Molecular Orbital No.  11:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.08965 a.u.                                                                  
               (   1 O   3s  :     1.00) (   1 O   1p0 :    -0.71) (   1 O   2p0 :     1.32)                              
               (   2 O   3s  :    -1.00) (   2 O   1p0 :    -0.71) (   2 O   2p0 :     1.32)                              
                                                                                                                          
               Molecular Orbital No.  12:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.10519 a.u.                                                                  
               (   1 O   1p+1:    -0.67) (   1 O   2p+1:     0.63) (   2 O   1p+1:    -0.67)                              
               (   2 O   2p+1:     0.63)                                                                                  
                                                                                                                          
               Molecular Orbital No.  13:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.11946 a.u.                                                                  
               (   1 O   1p-1:     0.68) (   1 O   2p-1:    -0.62) (   2 O   1p-1:     0.68)                              
               (   2 O   2p-1:    -0.62)                                                                                  
                                                                                                                          
                                                                                                                          
Total MCSCF time: 00:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -149.6134612416 a.u.                                                                                
* Info *   Gradient : 1.499811e-03 a.u. (RMS)                                                                             
* Info *              1.500021e-03 a.u. (Max)                                                                             
* Info *   Time     : 1.90 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                          Multi-Configurational Self-Consistent Field Driver
                         ====================================================
                                                                                                                          
        ╭────────────────────────────────────╮
        │          Driver settings           │
        ╰────────────────────────────────────╯
          State-specific calculation
          Max. iterations         : 50
          BFGS window             : 5
          Convergence thresholds:
            - Energy change       : 1e-08
            - Gradient norm       : 0.0001
                                                                                                                          
          Integrals in memory
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          Active space definition:
          ------------------------
Number of inactive (occupied) orbitals: 5
Number of active orbitals:              4
Number of virtual orbitals:             19

    This is a CASSCF wavefunction: CAS(6,4)

          CI expansion:
          -------------
Number of determinants:      10


                                                                                                                          
        MCSCF Iterations
        ----------------
                                                                                                                          
     Iter. | Average Energy | E. Change | Grad. Norm | CI Iter. |   Time
     ---------------------------------------------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        1     -149.613462031     0.0e+00      2.0e-03          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        2     -149.613462530    -5.0e-07      5.6e-04          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        3     -149.613462575    -4.6e-08      1.2e-04          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        4     -149.613462577    -1.3e-09      2.7e-05          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
** Convergence reached in 4 iterations
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        Final results
        -------------
                                                                                                                          
                                                                                                                          
* State 1
- Energy: -149.61346257674984
- S^2   : 0.00  (multiplicity = 1.0 )
- Natural orbitals
1.99871 1.99617 1.84385 0.16127
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.75869 a.u.                                                                  
               (   1 O   1p+1:    -0.46) (   1 O   2p+1:    -0.27) (   2 O   1p+1:    -0.46)                              
               (   2 O   2p+1:    -0.27)                                                                                  
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.44982 a.u.                                                                  
               (   1 O   1p+1:    -0.52) (   1 O   2p+1:    -0.41) (   2 O   1p+1:     0.52)                              
               (   2 O   2p+1:     0.41)                                                                                  
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.999 Energy:   -0.97418 a.u.                                                                  
               (   1 O   2s  :     0.26) (   1 O   3s  :     0.37) (   1 O   1p0 :    -0.32)                              
               (   1 O   2p0 :    -0.19) (   2 O   2s  :     0.26) (   2 O   3s  :     0.37)                              
               (   2 O   1p0 :     0.32) (   2 O   2p0 :     0.19)                                                        
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.996 Energy:   -1.09543 a.u.                                                                  
               (   1 O   2s  :     0.36) (   1 O   3s  :     0.46) (   2 O   2s  :    -0.36)                              
               (   2 O   3s  :    -0.46)                                                                                  
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.844 Energy:   -0.61778 a.u.                                                                  
               (   1 O   1p-1:    -0.44) (   1 O   2p-1:    -0.28) (   2 O   1p-1:    -0.44)                              
               (   2 O   2p-1:    -0.28)                                                                                  
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.161 Energy:    0.05037 a.u.                                                                  
               (   1 O   1p-1:     0.59) (   1 O   2p-1:     0.31) (   2 O   1p-1:    -0.59)                              
               (   2 O   2p-1:    -0.31)                                                                                  
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.47807 a.u.                                                                  
               (   1 O   2s  :     0.18) (   1 O   3s  :     1.29) (   1 O   1p0 :     0.40)                              
               (   1 O   2p0 :     1.24) (   2 O   2s  :    -0.18) (   2 O   3s  :    -1.29)                              
               (   2 O   1p0 :     0.40) (   2 O   2p0 :     1.24)                                                        
                                                                                                                          
               Molecular Orbital No.  11:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.08993 a.u.                                                                  
               (   1 O   3s  :    -1.00) (   1 O   1p0 :     0.71) (   1 O   2p0 :    -1.32)                              
               (   2 O   3s  :     1.00) (   2 O   1p0 :     0.71) (   2 O   2p0 :    -1.32)                              
                                                                                                                          
               Molecular Orbital No.  12:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.10515 a.u.                                                                  
               (   1 O   1p+1:     0.67) (   1 O   2p+1:    -0.63) (   2 O   1p+1:     0.67)                              
               (   2 O   2p+1:    -0.63)                                                                                  
                                                                                                                          
               Molecular Orbital No.  13:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.11938 a.u.                                                                  
               (   1 O   1p-1:     0.68) (   1 O   2p-1:    -0.62) (   2 O   1p-1:     0.68)                              
               (   2 O   2p-1:    -0.62)                                                                                  
                                                                                                                          
                                                                                                                          
Total MCSCF time: 00:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -149.6134625767 a.u.                                                                                
* Info *   Gradient : 3.545888e-04 a.u. (RMS)                                                                             
* Info *              3.547914e-04 a.u. (Max)                                                                             
* Info *   Time     : 2.04 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                          Multi-Configurational Self-Consistent Field Driver
                         ====================================================
                                                                                                                          
        ╭────────────────────────────────────╮
        │          Driver settings           │
        ╰────────────────────────────────────╯
          State-specific calculation
          Max. iterations         : 50
          BFGS window             : 5
          Convergence thresholds:
            - Energy change       : 1e-08
            - Gradient norm       : 0.0001
                                                                                                                          
          Integrals in memory
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          Active space definition:
          ------------------------
Number of inactive (occupied) orbitals: 5
Number of active orbitals:              4
Number of virtual orbitals:             19

    This is a CASSCF wavefunction: CAS(6,4)

          CI expansion:
          -------------
Number of determinants:      10


                                                                                                                          
        MCSCF Iterations
        ----------------
                                                                                                                          
     Iter. | Average Energy | E. Change | Grad. Norm | CI Iter. |   Time
     ---------------------------------------------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        1     -149.613462602     0.0e+00      6.3e-04          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        2     -149.613462651    -4.8e-08      1.7e-04          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        3     -149.613462655    -4.3e-09      3.8e-05          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
** Convergence reached in 3 iterations
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        Final results
        -------------
                                                                                                                          
                                                                                                                          
* State 1
- Energy: -149.61346265521846
- S^2   : 0.00  (multiplicity = 1.0 )
- Natural orbitals
1.99871 1.99617 1.84400 0.16112
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.75878 a.u.                                                                  
               (   1 O   1p+1:     0.46) (   1 O   2p+1:     0.27) (   2 O   1p+1:     0.46)                              
               (   2 O   2p+1:     0.27)                                                                                  
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.44973 a.u.                                                                  
               (   1 O   1p+1:    -0.52) (   1 O   2p+1:    -0.42) (   2 O   1p+1:     0.52)                              
               (   2 O   2p+1:     0.42)                                                                                  
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.999 Energy:   -0.97437 a.u.                                                                  
               (   1 O   2s  :     0.26) (   1 O   3s  :     0.37) (   1 O   1p0 :    -0.32)                              
               (   1 O   2p0 :    -0.19) (   2 O   2s  :     0.26) (   2 O   3s  :     0.37)                              
               (   2 O   1p0 :     0.32) (   2 O   2p0 :     0.19)                                                        
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.996 Energy:   -1.09535 a.u.                                                                  
               (   1 O   2s  :    -0.36) (   1 O   3s  :    -0.46) (   2 O   2s  :     0.36)                              
               (   2 O   3s  :     0.46)                                                                                  
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.844 Energy:   -0.61792 a.u.                                                                  
               (   1 O   1p-1:    -0.44) (   1 O   2p-1:    -0.28) (   2 O   1p-1:    -0.44)                              
               (   2 O   2p-1:    -0.28)                                                                                  
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.161 Energy:    0.05053 a.u.                                                                  
               (   1 O   1p-1:     0.59) (   1 O   2p-1:     0.31) (   2 O   1p-1:    -0.59)                              
               (   2 O   2p-1:    -0.31)                                                                                  
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.47836 a.u.                                                                  
               (   1 O   2s  :     0.18) (   1 O   3s  :     1.29) (   1 O   1p0 :     0.40)                              
               (   1 O   2p0 :     1.24) (   2 O   2s  :    -0.18) (   2 O   3s  :    -1.29)                              
               (   2 O   1p0 :     0.40) (   2 O   2p0 :     1.24)                                                        
                                                                                                                          
               Molecular Orbital No.  11:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.09001 a.u.                                                                  
               (   1 O   3s  :    -1.00) (   1 O   1p0 :     0.71) (   1 O   2p0 :    -1.32)                              
               (   2 O   3s  :     1.00) (   2 O   1p0 :     0.71) (   2 O   2p0 :    -1.32)                              
                                                                                                                          
               Molecular Orbital No.  12:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.10514 a.u.                                                                  
               (   1 O   1p+1:     0.67) (   1 O   2p+1:    -0.63) (   2 O   1p+1:     0.67)                              
               (   2 O   2p+1:    -0.63)                                                                                  
                                                                                                                          
               Molecular Orbital No.  13:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.11936 a.u.                                                                  
               (   1 O   1p-1:    -0.68) (   1 O   2p-1:     0.62) (   2 O   1p-1:    -0.68)                              
               (   2 O   2p-1:     0.62)                                                                                  
                                                                                                                          
                                                                                                                          
Total MCSCF time: 00:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -149.6134626552 a.u.                                                                                
* Info *   Gradient : 1.606173e-06 a.u. (RMS)                                                                             
* Info *              1.782009e-06 a.u. (Max)                                                                             
* Info *   Time     : 1.92 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Saving file: veloxchem_opt_2023-06-05T14.18.28_optim.xyz                                                         
* Info * Saving file: veloxchem_opt_2023-06-05T14.18.28.log                                                               
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Geometry optimization completed.                                                                                 
                                                                                                                          
                                              Molecular Geometry (Angstroms)                                              
                                             ================================                                             
                                                                                                                          
                          Atom         Coordinate X          Coordinate Y          Coordinate Z                           
                                                                                                                          
                           O          -0.000012463515        0.000028159284       -0.599514253124                         
                           O           0.000001103720        0.000030350703        0.599494151540                         
                                                                                                                          
                                                                                                                          
                                             Summary of Geometry Optimization                                             
                                            ==================================                                            
                                                                                                                          
                  Opt.Step       Energy (a.u.)       Energy Change (a.u.)       Displacement (RMS, Max)                   
                  -------------------------------------------------------------------------------------                   
                      0        -149.613461241593        0.000000000000         0.000e+00      0.000e+00                   
                      1        -149.613462576750       -0.000001335157         3.786e-04      3.786e-04                   
                      2        -149.613462655218       -0.000000078469         1.172e-04      1.172e-04                   
                                                                                                                          
                                                                                                                          
                                              Statistical Deviation between                                               
                                         Optimized Geometry and Initial Geometry                                          
                                        =========================================                                         
                                                                                                                          
                               Internal Coord.        RMS deviation         Max. deviation                                
                               -----------------------------------------------------------                                
                                  Bonds               0.001 Angstrom        0.001 Angstrom                                
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                     *** Time spent in Optimization Driver: 5.89 sec                                      
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<p>We can now use this new geometry in subsequent calculations.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">molecule</span><span class="o">=</span><span class="n">casscf_opt_geom</span>
<span class="n">mc_results</span> <span class="o">=</span> <span class="n">mcscfdrv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span><span class="n">basis</span><span class="p">,</span><span class="n">space</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                          Multi-Configurational Self-Consistent Field Driver
                         ====================================================
                                                                                                                          
        ╭────────────────────────────────────╮
        │          Driver settings           │
        ╰────────────────────────────────────╯
          State-specific calculation
          Max. iterations         : 50
          BFGS window             : 5
          Convergence thresholds:
            - Energy change       : 1e-08
            - Gradient norm       : 0.0001
                                                                                                                          
          Integrals in memory
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          Active space definition:
          ------------------------
Number of inactive (occupied) orbitals: 5
Number of active orbitals:              4
Number of virtual orbitals:             19

    This is a CASSCF wavefunction: CAS(6,4)

          CI expansion:
          -------------
Number of determinants:      10


                                                                                                                          
        MCSCF Iterations
        ----------------
                                                                                                                          
     Iter. | Average Energy | E. Change | Grad. Norm | CI Iter. |   Time
     ---------------------------------------------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        1     -149.613462655     0.0e+00      1.9e-05          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
** Convergence reached in 1 iterations
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        Final results
        -------------
                                                                                                                          
                                                                                                                          
* State 1
- Energy: -149.61346265530923
- S^2   : 0.00  (multiplicity = 1.0 )
- Natural orbitals
1.99871 1.99617 1.84400 0.16112
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.75878 a.u.                                                                  
               (   1 O   1p+1:    -0.46) (   1 O   2p+1:    -0.27) (   2 O   1p+1:    -0.46)                              
               (   2 O   2p+1:    -0.27)                                                                                  
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.44973 a.u.                                                                  
               (   1 O   1p+1:     0.52) (   1 O   2p+1:     0.42) (   2 O   1p+1:    -0.52)                              
               (   2 O   2p+1:    -0.42)                                                                                  
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.999 Energy:   -0.97448 a.u.                                                                  
               (   1 O   2s  :    -0.26) (   1 O   3s  :    -0.37) (   1 O   1p0 :     0.32)                              
               (   1 O   2p0 :     0.19) (   2 O   2s  :    -0.26) (   2 O   3s  :    -0.37)                              
               (   2 O   1p0 :    -0.32) (   2 O   2p0 :    -0.19)                                                        
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.996 Energy:   -1.09535 a.u.                                                                  
               (   1 O   2s  :     0.36) (   1 O   3s  :     0.46) (   2 O   2s  :    -0.36)                              
               (   2 O   3s  :    -0.46)                                                                                  
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.844 Energy:   -0.61792 a.u.                                                                  
               (   1 O   1p-1:     0.44) (   1 O   2p-1:     0.28) (   2 O   1p-1:     0.44)                              
               (   2 O   2p-1:     0.28)                                                                                  
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.161 Energy:    0.05053 a.u.                                                                  
               (   1 O   1p-1:     0.59) (   1 O   2p-1:     0.31) (   2 O   1p-1:    -0.59)                              
               (   2 O   2p-1:    -0.31)                                                                                  
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.47836 a.u.                                                                  
               (   1 O   2s  :     0.18) (   1 O   3s  :     1.29) (   1 O   1p0 :     0.40)                              
               (   1 O   2p0 :     1.24) (   2 O   2s  :    -0.18) (   2 O   3s  :    -1.29)                              
               (   2 O   1p0 :     0.40) (   2 O   2p0 :     1.24)                                                        
                                                                                                                          
               Molecular Orbital No.  11:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.09001 a.u.                                                                  
               (   1 O   3s  :     1.00) (   1 O   1p0 :    -0.71) (   1 O   2p0 :     1.32)                              
               (   2 O   3s  :    -1.00) (   2 O   1p0 :    -0.71) (   2 O   2p0 :     1.32)                              
                                                                                                                          
               Molecular Orbital No.  12:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.10514 a.u.                                                                  
               (   1 O   1p+1:     0.67) (   1 O   2p+1:    -0.63) (   2 O   1p+1:     0.67)                              
               (   2 O   2p+1:    -0.63)                                                                                  
                                                                                                                          
               Molecular Orbital No.  13:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.11936 a.u.                                                                  
               (   1 O   1p-1:    -0.68) (   1 O   2p-1:     0.62) (   2 O   1p-1:    -0.68)                              
               (   2 O   2p-1:     0.62)                                                                                  
                                                                                                                          
                                                                                                                          
Total MCSCF time: 00:00:00
</pre></div>
</div>
</div>
</div>
<p>If your MCSCF calculation is a state-averaged, you should extend the parameters of the compute function with the number of states in the state-averaging and the index (starting from 0) of the state you wish to optimize:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">casscf_opt_geom</span> <span class="o">=</span> <span class="n">opt_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">space</span><span class="p">,</span> <span class="n">nstates</span><span class="p">,</span> <span class="n">istate</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="spectroscopy">
<h2>Spectroscopy<a class="headerlink" href="#spectroscopy" title="Permalink to this headline">¶</a></h2>
<div class="section" id="state-averaging">
<h3>State-averaging<a class="headerlink" href="#state-averaging" title="Permalink to this headline">¶</a></h3>
<p>MCSCF is commonly used to simulate spectroscopy and photochemistry. There are several ways to compute excited state properties from a MCSCF calculation. As discussed in the previous section, one way is to use state-averaging:</p>
<p>Let’s go back to our furan calculation. First we compute a SA-CASSCF with 5 states:</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">furan_xyz</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;9</span>

<span class="s2"> C     -0.86213    -0.90784     0.00007</span>
<span class="s2"> H     -1.63433    -1.64264    -0.00003</span>
<span class="s2"> C      0.50727    -0.90524     0.00007</span>
<span class="s2"> C      0.92057     0.47886    -0.00003</span>
<span class="s2"> C     -0.22323     1.23186    -0.00003</span>
<span class="s2"> O     -1.35123     0.40376    -0.00013</span>
<span class="s2"> H      1.17117    -1.74724     0.00017</span>
<span class="s2"> H      1.93767     0.81866     0.00007</span>
<span class="s2"> H     -0.46573     2.26986    -0.00013</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">molecule</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_xyz_string</span><span class="p">(</span><span class="n">furan_xyz</span><span class="p">)</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">MolecularBasis</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span><span class="s2">&quot;def2-sv(p)&quot;</span><span class="p">)</span>

<span class="c1">#We use a previously stored h5 file for the active space</span>
<span class="n">space</span><span class="o">=</span><span class="n">mtp</span><span class="o">.</span><span class="n">OrbSpace</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span><span class="s2">&quot;furan-cas.h5&quot;</span><span class="p">)</span>
<span class="n">mcscfdrv</span><span class="o">=</span><span class="n">mtp</span><span class="o">.</span><span class="n">McscfDriver</span><span class="p">()</span>
<span class="n">mc_results</span> <span class="o">=</span> <span class="n">mcscfdrv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span><span class="n">basis</span><span class="p">,</span><span class="n">space</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1">#state-averaged with 5 states</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Reading basis set from file: /opt/anaconda3/envs/vlxenv/lib/python3.9/site-packages/veloxchem/basis/DEF2-SV_P_   
                                                                                                                          
                                              Molecular Basis (Atomic Basis)                                              
                                             ================================                                             
                                                                                                                          
                               Basis: DEF2-SV(P)                                                                          
                                                                                                                          
                               Atom Contracted GTOs           Primitive GTOs                                              
                                                                                                                          
                                O   (3S,2P,1D)                (7S,4P,1D)                                                  
                                H   (2S)                      (4S)                                                        
                                C   (3S,2P,1D)                (7S,4P,1D)                                                  
                                                                                                                          
                               Contracted Basis Functions : 78                                                            
                               Primitive Basis Functions  : 136                                                           
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                          Multi-Configurational Self-Consistent Field Driver
                         ====================================================
                                                                                                                          
        ╭────────────────────────────────────╮
        │          Driver settings           │
        ╰────────────────────────────────────╯
          State-averaged calculation
            Number of states      : 5
            Equal-weights 
          Max. iterations         : 50
          BFGS window             : 5
          Convergence thresholds:
            - Energy change       : 1e-08
            - Gradient norm       : 0.0001
                                                                                                                          
          Integrals in memory
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          Active space definition:
          ------------------------
Number of inactive (occupied) orbitals: 15
Number of active orbitals:              5
Number of virtual orbitals:             58

    This is a CASSCF wavefunction: CAS(6,5)

          CI expansion:
          -------------
Number of determinants:      55


                                                                                                                          
        MCSCF Iterations
        ----------------
                                                                                                                          
     Iter. | Average Energy | E. Change | Grad. Norm | CI Iter. |   Time
     ---------------------------------------------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        1     -228.211383987     0.0e+00      1.6e-01          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        2     -228.223997559    -1.3e-02      8.1e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        3     -228.226393803    -2.4e-03      1.8e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        4     -228.226480980    -8.7e-05      4.4e-03          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        5     -228.226488145    -7.2e-06      7.9e-04          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        6     -228.226488311    -1.7e-07      1.9e-04          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        7     -228.226488323    -1.1e-08      4.7e-05          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        8     -228.226488324    -8.9e-10      1.5e-05          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
** Convergence reached in 8 iterations
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        Final results
        -------------
                                                                                                                          
                                                                                                                          
* State 1
- Energy: -228.48133300321214
- S^2   : 0.00  (multiplicity = 1.0 )
- Natural orbitals
1.99277 1.94494 1.90452 0.09562 0.06215
                                                                                                                          
* State 2
- Energy: -228.23632225186455
- S^2   : -0.00  (multiplicity = 1.0 )
- Natural orbitals
1.98998 1.43257 1.34064 0.74092 0.49589
                                                                                                                          
* State 3
- Energy: -228.176596544003
- S^2   : -0.00  (multiplicity = 1.0 )
- Natural orbitals
1.97827 1.94567 1.03236 0.97318 0.07053
                                                                                                                          
* State 4
- Energy: -228.12869622259313
- S^2   : 12.00  (multiplicity = 7.0 )
- Natural orbitals
2.00000 1.00000 1.00000 1.00000 1.00000
                                                                                                                          
* State 5
- Energy: -228.10949359641953
- S^2   : 0.00  (multiplicity = 1.0 )
- Natural orbitals
1.95161 1.39436 1.25216 1.09983 0.30204
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.  14:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.56530 a.u.                                                                  
               (   3 C   1p-1:     0.26) (   4 C   1p+1:    -0.22) (   4 C   1p-1:    -0.16)                              
               (   6 O   1p+1:    -0.43) (   6 O   2p+1:    -0.32) (   7 H   1s  :    -0.19)                              
               (   8 H   1s  :    -0.19)                                                                                  
                                                                                                                          
               Molecular Orbital No.  15:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.54782 a.u.                                                                  
               (   1 C   1p+1:    -0.25) (   2 H   1s  :     0.16) (   3 C   1p+1:     0.21)                              
               (   3 C   1p-1:     0.27) (   4 C   1p-1:    -0.34) (   4 C   2p-1:    -0.16)                              
               (   5 C   1p+1:    -0.22) (   6 O   1p+1:     0.22) (   6 O   2p+1:     0.17)                              
               (   9 H   1s  :     0.16)                                                                                  
                                                                                                                          
               Molecular Orbital No.  16:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.939 Energy:   -0.59865 a.u.                                                                  
               (   1 C   1p0 :    -0.19) (   5 C   1p0 :    -0.19) (   6 O   1p0 :    -0.51)                              
               (   6 O   2p0 :    -0.36)                                                                                  
                                                                                                                          
               Molecular Orbital No.  17:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.566 Energy:   -0.34141 a.u.                                                                  
               (   3 C   1p0 :    -0.35) (   3 C   2p0 :    -0.26) (   4 C   1p0 :    -0.35)                              
               (   4 C   2p0 :    -0.26) (   6 O   1p0 :     0.30) (   6 O   2p0 :     0.25)                              
                                                                                                                          
               Molecular Orbital No.  18:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.296 Energy:   -0.23339 a.u.                                                                  
               (   1 C   1p0 :     0.37) (   1 C   2p0 :     0.29) (   3 C   1p0 :     0.23)                              
               (   3 C   2p0 :     0.19) (   4 C   1p0 :    -0.23) (   4 C   2p0 :    -0.19)                              
               (   5 C   1p0 :    -0.37) (   5 C   2p0 :    -0.29)                                                        
                                                                                                                          
               Molecular Orbital No.  19:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.803 Energy:    0.04710 a.u.                                                                  
               (   1 C   1p0 :    -0.40) (   1 C   2p0 :    -0.47) (   3 C   1p0 :     0.17)                              
               (   3 C   2p0 :     0.28) (   4 C   1p0 :     0.17) (   4 C   2p0 :     0.28)                              
               (   5 C   1p0 :    -0.40) (   5 C   2p0 :    -0.47) (   6 O   1p0 :     0.31)                              
               (   6 O   2p0 :     0.37)                                                                                  
                                                                                                                          
               Molecular Orbital No.  20:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.396 Energy:    0.18364 a.u.                                                                  
               (   1 C   1p0 :    -0.29) (   1 C   2p0 :    -0.38) (   3 C   1p0 :     0.43)                              
               (   3 C   2p0 :     0.61) (   4 C   1p0 :    -0.43) (   4 C   2p0 :    -0.61)                              
               (   5 C   1p0 :     0.29) (   5 C   2p0 :     0.38)                                                        
                                                                                                                          
               Molecular Orbital No.  21:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.20635 a.u.                                                                  
               (   1 C   3s  :     0.65) (   1 C   2p+1:    -0.30) (   1 C   2p-1:    -0.24)                              
               (   2 H   2s  :    -0.98) (   3 C   3s  :     0.97) (   3 C   2p+1:     0.29)                              
               (   3 C   2p-1:    -0.39) (   4 C   3s  :     0.97) (   4 C   2p+1:     0.46)                              
               (   4 C   2p-1:     0.17) (   5 C   3s  :     0.65) (   5 C   2p-1:     0.36)                              
               (   7 H   2s  :    -1.31) (   8 H   2s  :    -1.31) (   9 H   2s  :    -0.98)                              
                                                                                                                          
               Molecular Orbital No.  22:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.23239 a.u.                                                                  
               (   1 C   3s  :     0.74) (   1 C   2p+1:    -0.86) (   1 C   2p-1:    -0.80)                              
               (   2 H   2s  :    -1.90) (   3 C   3s  :     1.09) (   3 C   2p-1:     0.24)                              
               (   4 C   3s  :    -1.10) (   4 C   2p-1:     0.20) (   5 C   3s  :    -0.73)                              
               (   5 C   1p-1:    -0.16) (   5 C   2p+1:     0.28) (   5 C   2p-1:    -1.14)                              
               (   7 H   2s  :    -0.34) (   8 H   2s  :     0.35) (   9 H   2s  :     1.89)                              
                                                                                                                          
               Molecular Orbital No.  23:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.23464 a.u.                                                                  
               (   1 C   3s  :     0.95) (   1 C   2p+1:    -0.61) (   1 C   2p-1:    -0.55)                              
               (   2 H   2s  :    -1.56) (   3 C   3s  :    -0.61) (   3 C   2p+1:    -0.33)                              
               (   3 C   2p-1:     0.60) (   4 C   3s  :    -0.60) (   4 C   2p+1:    -0.60)                              
               (   4 C   2p-1:    -0.32) (   5 C   3s  :     0.96) (   5 C   2p+1:    -0.21)                              
               (   5 C   2p-1:     0.81) (   7 H   2s  :     1.13) (   8 H   2s  :     1.13)                              
               (   9 H   2s  :    -1.57)                                                                                  
                                                                                                                          
                                                                                                                          
Total MCSCF time: 00:00:01
</pre></div>
</div>
</div>
</div>
<p>Now we can compute the transition properties using the InterState module. This module requires the dictionary returned by the MCSCF.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Compute oscillator strengths</span>
<span class="n">SI</span><span class="o">=</span><span class="n">mtp</span><span class="o">.</span><span class="n">InterState</span><span class="p">()</span>
<span class="n">Prop_dict</span><span class="o">=</span><span class="n">SI</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span><span class="n">basis</span><span class="p">,</span> <span class="n">mc_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
List of oscillator strengths greather than 1e-10
                                                                                                                          
  From     to       Energy (eV)    Oscillator strength (length and velocity)
     1       2        6.66708         3.935228e-03    2.925456e-03
     1       3        8.29230         2.426600e-01    1.672872e-01
     1       5       10.11827         5.706685e-01    4.028088e-01
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
List of rotatory strengths greater than 1e-10
                                                                                                                          
  From     to       Energy (eV)    Rot. strength (a.u. and 10^-40 cgs)
     1       2        6.66708         8.842626e-08        0.000042
     1       3        8.29230        -5.376861e-06       -0.002535
     1       5       10.11827        -1.256445e-05       -0.005923
</pre></div>
</div>
</div>
</div>
<p>The function returns a dictionary with the most important values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">Prop_dict</span><span class="p">[</span><span class="s2">&quot;energies&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Prop_dict</span><span class="p">[</span><span class="s2">&quot;oscillator_strengths&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.24501075 0.30473646 0.35263678 0.37183941]
[3.93522815e-03 2.42660014e-01 7.80846838e-26 5.70668499e-01]
</pre></div>
</div>
</div>
</div>
<p>By default InterState computes properties from the first state to all others, but this can be changed by providing the list of “initial” and “final” states as arguments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Prop_dict</span><span class="o">=</span><span class="n">SI</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span><span class="n">basis</span><span class="p">,</span><span class="n">mc_results</span><span class="p">,</span> <span class="n">from_states</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">to_states</span><span class="o">=</span><span class="s1">&#39;all&#39;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
List of oscillator strengths greather than 1e-10
                                                                                                                          
  From     to       Energy (eV)    Oscillator strength (length and velocity)
     1       2        6.66708         3.935228e-03    2.925456e-03
     1       3        8.29230         2.426600e-01    1.672872e-01
     1       5       10.11827         5.706685e-01    4.028088e-01
     2       3        1.62522         2.610885e-02    2.178061e-02
     2       5        3.45118         1.364278e-03    1.798930e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
List of rotatory strengths greater than 1e-10
                                                                                                                          
  From     to       Energy (eV)    Rot. strength (a.u. and 10^-40 cgs)
     1       2        6.66708         8.842626e-08        0.000042
     1       3        8.29230        -5.376861e-06       -0.002535
     1       5       10.11827        -1.256445e-05       -0.005923
     2       1       -6.66708        -8.842626e-08       -0.000042
     2       3        1.62522         1.447843e-05        0.006826
     2       5        3.45118        -1.053302e-07       -0.000050
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="linear-response">
<h3>Linear response<a class="headerlink" href="#linear-response" title="Permalink to this headline">¶</a></h3>
<p>Another way to compute excited state properties at the MCSCF level is using linear response. This multiconfigurational linear response (MCLR) requires first a MCSCF calculation of the ground state and then the use of the Mclr_EigenSolver module:</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mcscfdrv</span><span class="o">=</span><span class="n">mtp</span><span class="o">.</span><span class="n">McscfDriver</span><span class="p">()</span>
<span class="n">mc_results</span> <span class="o">=</span> <span class="n">mcscfdrv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span><span class="n">basis</span><span class="p">,</span><span class="n">space</span><span class="p">)</span> <span class="c1">#only ground state!</span>

<span class="n">mcrpa</span> <span class="o">=</span> <span class="n">mtp</span><span class="o">.</span><span class="n">Mclr_EigenSolver</span><span class="p">()</span>
<span class="n">Prop_dict</span> <span class="o">=</span> <span class="n">mcrpa</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">mcscfdrv</span><span class="p">,</span> <span class="n">n_states</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                          Multi-Configurational Self-Consistent Field Driver
                         ====================================================
                                                                                                                          
        ╭────────────────────────────────────╮
        │          Driver settings           │
        ╰────────────────────────────────────╯
          State-specific calculation
          Max. iterations         : 50
          BFGS window             : 5
          Convergence thresholds:
            - Energy change       : 1e-08
            - Gradient norm       : 0.0001
                                                                                                                          
          Integrals in memory
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          Active space definition:
          ------------------------
Number of inactive (occupied) orbitals: 15
Number of active orbitals:              5
Number of virtual orbitals:             58

    This is a CASSCF wavefunction: CAS(6,5)

          CI expansion:
          -------------
Number of determinants:      55


                                                                                                                          
        MCSCF Iterations
        ----------------
                                                                                                                          
     Iter. | Average Energy | E. Change | Grad. Norm | CI Iter. |   Time
     ---------------------------------------------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        1     -228.481333003     0.0e+00      1.0e-01          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        2     -228.487054041    -5.7e-03      4.6e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        3     -228.487922618    -8.7e-04      1.8e-02          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        4     -228.488009745    -8.7e-05      3.9e-03          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        5     -228.488013864    -4.1e-06      8.0e-04          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        6     -228.488014067    -2.0e-07      1.8e-04          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        7     -228.488014076    -8.8e-09      5.1e-05          1   0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
** Convergence reached in 7 iterations
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        Final results
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        -------------
                                                                                                                          
                                                                                                                          
* State 1
- Energy: -228.48801407603156
- S^2   : 0.00  (multiplicity = 1.0 )
- Natural orbitals
1.99451 1.94212 1.90287 0.09708 0.06342
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.  14:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.55816 a.u.                                                                  
               (   3 C   1p-1:     0.32) (   4 C   1p+1:    -0.19) (   4 C   1p-1:    -0.26)                              
               (   6 O   1p+1:    -0.35) (   6 O   2p+1:    -0.26) (   7 H   1s  :    -0.20)                              
               (   8 H   1s  :    -0.20)                                                                                  
                                                                                                                          
               Molecular Orbital No.  15:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.54203 a.u.                                                                  
               (   1 C   1p+1:     0.25) (   3 C   1p+1:    -0.23) (   3 C   1p-1:    -0.18)                              
               (   4 C   1p-1:     0.27) (   5 C   1p+1:     0.24) (   6 O   1p+1:    -0.34)                              
               (   6 O   2p+1:    -0.27)                                                                                  
                                                                                                                          
               Molecular Orbital No.  16:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.995 Energy:   -0.58222 a.u.                                                                  
               (   6 O   1p0 :     0.59) (   6 O   2p0 :     0.43)                                                        
                                                                                                                          
               Molecular Orbital No.  17:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.942 Energy:   -0.41897 a.u.                                                                  
               (   1 C   1p0 :    -0.19) (   3 C   1p0 :    -0.34) (   3 C   2p0 :    -0.23)                              
               (   4 C   1p0 :    -0.34) (   4 C   2p0 :    -0.23) (   5 C   1p0 :    -0.19)                              
               (   6 O   2p0 :     0.15)                                                                                  
                                                                                                                          
               Molecular Orbital No.  18:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.903 Energy:   -0.30937 a.u.                                                                  
               (   1 C   1p0 :     0.36) (   1 C   2p0 :     0.28) (   3 C   1p0 :     0.24)                              
               (   3 C   2p0 :     0.20) (   4 C   1p0 :    -0.24) (   4 C   2p0 :    -0.20)                              
               (   5 C   1p0 :    -0.36) (   5 C   2p0 :    -0.28)                                                        
                                                                                                                          
               Molecular Orbital No.  19:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.097 Energy:    0.18407 a.u.                                                                  
               (   1 C   1p0 :    -0.48) (   1 C   2p0 :    -0.30) (   3 C   1p0 :     0.30)                              
               (   3 C   2p0 :     0.18) (   4 C   1p0 :     0.30) (   4 C   2p0 :     0.18)                              
               (   5 C   1p0 :    -0.48) (   5 C   2p0 :    -0.30) (   6 O   1p0 :     0.28)                              
               (   6 O   2p0 :     0.27)                                                                                  
                                                                                                                          
               Molecular Orbital No.  20:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.063 Energy:    0.28637 a.u.                                                                  
               (   1 C   1p0 :    -0.36) (   1 C   2p0 :    -0.24) (   3 C   1p0 :     0.51)                              
               (   3 C   2p0 :     0.39) (   4 C   1p0 :    -0.51) (   4 C   2p0 :    -0.39)                              
               (   5 C   1p0 :     0.36) (   5 C   2p0 :     0.24)                                                        
                                                                                                                          
               Molecular Orbital No.  21:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.20569 a.u.                                                                  
               (   1 C   3s  :     0.62) (   1 C   2p+1:    -0.28) (   1 C   2p-1:    -0.21)                              
               (   2 H   2s  :    -0.93) (   3 C   3s  :     0.99) (   3 C   2p+1:     0.30)                              
               (   3 C   2p-1:    -0.41) (   4 C   3s  :     0.99) (   4 C   2p+1:     0.48)                              
               (   4 C   2p-1:     0.18) (   5 C   3s  :     0.62) (   5 C   2p-1:     0.33)                              
               (   7 H   2s  :    -1.35) (   8 H   2s  :    -1.35) (   9 H   2s  :    -0.93)                              
                                                                                                                          
               Molecular Orbital No.  22:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.23274 a.u.                                                                  
               (   1 C   3s  :    -0.75) (   1 C   2p+1:     0.85) (   1 C   2p-1:     0.79)                              
               (   2 H   2s  :     1.89) (   3 C   3s  :    -1.12) (   3 C   2p-1:    -0.22)                              
               (   4 C   3s  :     1.13) (   4 C   2p-1:    -0.19) (   5 C   3s  :     0.74)                              
               (   5 C   1p-1:     0.16) (   5 C   2p+1:    -0.28) (   5 C   2p-1:     1.12)                              
               (   7 H   2s  :     0.40) (   8 H   2s  :    -0.41) (   9 H   2s  :    -1.87)                              
                                                                                                                          
               Molecular Orbital No.  23:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.23429 a.u.                                                                  
               (   1 C   3s  :     0.96) (   1 C   2p+1:    -0.62) (   1 C   2p-1:    -0.58)                              
               (   2 H   2s  :    -1.58) (   3 C   3s  :    -0.57) (   3 C   2p+1:    -0.32)                              
               (   3 C   2p-1:     0.59) (   4 C   3s  :    -0.57) (   4 C   2p+1:    -0.59)                              
               (   4 C   2p-1:    -0.32) (   5 C   3s  :     0.96) (   5 C   2p+1:    -0.21)                              
               (   5 C   2p-1:     0.83) (   7 H   2s  :     1.10) (   8 H   2s  :     1.10)                              
               (   9 H   2s  :    -1.60)                                                                                  
                                                                                                                          
                                                                                                                          
Total MCSCF time: 00:00:01
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
Initialization time: 00:00:00
                                                                                                                          
          Linear eigensolver
          ------------------
                                                                                                                          
CI parameters:      54
Orbital parameters: 1235
                                                                                                                          
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
        MC-RPA Iterations
        -----------------
                                                                                                                          
     Iter. | Average Energy | Grad. Norm | Converged | CI+Orb vec. | Time
     -----------------------------------------------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        1       0.354473745      8.6e-02      1/  5     5 +   5      0:00:00    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        2       0.322905104      2.5e-03      1/  5     5 +  13      0:00:00    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        3       0.318950137      5.4e-02      0/  5     5 +  21      0:00:00    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        4       0.307132284      3.5e-03      0/  5     9 +  27      0:00:00    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        5       0.306280016      1.0e-03      0/  5     9 +  37      0:00:00    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        6       0.305224566      6.2e-04      0/  5    15 +  41      0:00:00    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        7       0.305063289      3.9e-04      0/  5    15 +  51      0:00:00    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        8       0.304861693      8.4e-05      0/  5    21 +  55      0:00:00    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        9       0.304826594      2.5e-05      0/  5    23 +  63      0:00:00    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       10       0.304822607      4.2e-06      0/  5    27 +  26      0:00:00    Orb subspace collapsed 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       11       0.304821650      1.8e-06      1/  5    27 +  36      0:00:00    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       12       0.304820525      4.1e-07      3/  5    31 +  40      0:00:00    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       13       0.304820181      2.6e-07      3/  5    31 +  44      0:00:00    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       14       0.304819993      8.9e-08      3/  5    33 +  46      0:00:00    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       15       0.304819945      2.3e-08      4/  5    33 +  50      0:00:00    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       16       0.304819930      1.6e-08      4/  5    33 +  52      0:00:00    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       17       0.304819919      1.0e-08      4/  5    33 +  54      0:00:00    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       18       0.304819913      9.4e-09      5/  5    33 +  56      0:00:00    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
** Convergence reached in 18 iterations
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                                                                                          
                                                 Oscillator strength (au)
 Transition   Energy (Ha)    Energy (eV)    Velocity gauge     Length gauge 
  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
          1     0.2423283      6.59409          0.0007390        0.0017307
          2     0.2712909      7.38220          0.0970218        0.1191411
          3     0.3257755      8.86480          0.3250027        0.3709655
          4     0.3306552      8.99759          0.0000000        0.0000000
          5     0.3540496      9.63418          0.0097054        0.0071585
                                                                                                                          
                                                                                                                          
                                                 Rotatory strength (cgs)
 Transition   Energy (Ha)    Energy (eV)    Velocity gauge     Length gauge 
 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
          1     0.2423283      6.59409          0.0000294        0.0000525
          2     0.2712909      7.38220         -0.0055848       -0.0060698
          3     0.3257755      8.86480         -0.0225520       -0.0240950
          4     0.3306552      8.99759          0.0210917        0.0223028
          5     0.3540496      9.63418         -0.0016074       -0.0013716
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
Total MC-RPA time: 00:00:08
</pre></div>
</div>
</div>
</div>
<p>Again, the Prop_dict dictionary gives us access to the most important values. It is also possible to get an analysis of the dominant excitation character using the command:</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mcrpa</span><span class="o">.</span><span class="n">get_excitation_character</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
    Excitation characters
    ---------------------
                                                                                                                          
* State 1
- Exc. energy: 0.24232834425549662
 Electrons     Excitation
 0.344    :   17  -&gt;   19
 0.260    :   18  -&gt;   20
 CI weight: 0.971  Orb weight: 0.029
                                                                                                                          
* State 2
- Exc. energy: 0.271290900324328
 Electrons     Excitation
 0.906    :   18  -&gt;   19
 CI weight: 0.928  Orb weight: 0.072
                                                                                                                          
* State 3
- Exc. energy: 0.3257754793900555
 Electrons     Excitation
 0.303    :   18  -&gt;   20
 0.264    :   17  -&gt;   19
 0.241    :   16  -&gt;   19
 CI weight: 0.924  Orb weight: 0.076
                                                                                                                          
* State 4
- Exc. energy: 0.330655249141654
 Electrons     Excitation
 0.794    :   18  -&gt;   21
 CI weight: 0.000  Orb weight: 1.000
                                                                                                                          
* State 5
- Exc. energy: 0.3540495926926232
 Electrons     Excitation
 0.638    :   18  -&gt;   22
 0.214    :   17  -&gt;   21
 CI weight: 0.000  Orb weight: 1.000
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<p>In this analysis, we can see one of the most attractive feature of linear response compared to state-averaging: linear response also includes excitation from or to non-active orbitals. In this example, state 4 and 5 include excitations from the <span class="math notranslate nohighlight">\(\pi\)</span> orbitals to some higher lying <span class="math notranslate nohighlight">\(\sigma\)</span> orbitals. This feature is particularily useful for molecules with heteroatom lone pairs which do not contribute to the correlation in the active space (and are often difficult to keep in it) but often contribute to some of the lowest-lying excitations.</p>
<p>Another advantage of linear response is that unlike state-averaging, the excitation energies does not depend on the number of calculated states (except when the code accidentally converges to a higher solution, in which case increasing the number of states tends to ensure we get actually the lowest ones). Overall, in most cases, linear response provides more accurate excitation energies than state-averaging.</p>
<p>Note that the Tamm-Dancoff approximation is also available (using the property “mcrpa.tda = True”) which gives a slightly faster but less accurate calculation.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="mcscf.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">MCSCF</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="active-space.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Selecting an active space</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By The MultiPsi developers<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>